<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Shader</title>
		<style>
			body {
				margin: 0;
				padding: 0;
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<div id="webgl"></div>
	</body>
	<script type="importmap">
		{
			"imports": {
				"three": "../../../build/three.module.js",
				"three/addons/": "../../../examples/jsm/"
			}
		}
	</script>
	<script type="module">
		import * as THREE from "three";
		import {
			initRenderer,
			initCamera,
			initStats,
			addHouseAndTree,
		} from "./utils.js";
		import { OrbitControls } from "three/addons/controls/OrbitControls.js";
		import { GUI } from "three/addons/libs/lil-gui.module.min.js";

		let w = window.innerWidth;
		let h = window.innerHeight;

		let renderer, camera, scene, stats;

		function init() {
			renderer = initRenderer({ antialias: true });
			renderer.setClearColor(0xe6ffff, 1);
			camera = initCamera();
			scene = new THREE.Scene();

			const light = new THREE.PointLight(0xffffff, 2.5, 0, 0);
			scene.add(light);

			const axes = new THREE.AxesHelper(20);
			scene.add(axes);


      // 长 宽 圆角半径 圆角段数
      function drawShape(height, width, radius, length) {
        const shape = new THREE.Shape();
        shape.moveTo(0, width - radius);
        shape.lineTo(0, radius);

        for (let i = 1; i <= length; i++) {
          let a = Math.sin((Math.PI / length / 2) * i) * radius
          let b = Math.cos((Math.PI / length / 2) * i) * radius
          shape.lineTo(radius - b, radius - a)
        }

        shape.lineTo(height - radius, 0)

        for (let i = 1; i <= length; i++) {
          let a = Math.sin((Math.PI / length / 2) * i) * radius
          let b = Math.cos((Math.PI / length / 2) * i) * radius
          shape.lineTo(height - radius + a, radius - b)
        }

        shape.lineTo(height, width - radius)

        for (let i = 1; i <= length; i++) {
          let a = Math.sin((Math.PI / length / 2) * i) * radius
          let b = Math.cos((Math.PI / length / 2) * i) * radius
          shape.lineTo(height - radius + b, width - radius + a)
        }

        shape.lineTo(radius, width)

        for (let i = 1; i <= length; i++) {
          let a = Math.sin((Math.PI / length / 2) * i) * radius
          let b = Math.cos((Math.PI / length / 2) * i) * radius
          shape.lineTo(radius - a, width - radius + b)
        }
        return shape
      }

      const shape = drawShape(50, 10, 5, 2)
      const curve = new THREE.LineCurve3(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 4, 0))
      const extrudeSettings = {
        bevelEnabled: false,
        extrudePath: curve
      }

      const geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings)
      const material = new THREE.MeshBasicMaterial({ color: 0xf0f1f2, wireframe: false })
      const mesh = new THREE.Mesh(geometry, material);
      mesh.position.set(0, 0, 0);
      scene.add(mesh);

			const cont = new OrbitControls(camera, renderer.domElement);
			cont.update();

			document.getElementById("webgl").appendChild(renderer.domElement);

			function render() {
				renderer.render(scene, camera);
				requestAnimationFrame(render);
			}
			render();
			
		}

		init();
		
	</script>
</html>
